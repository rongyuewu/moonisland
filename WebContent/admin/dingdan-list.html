<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta name="renderer" content="webkit|ie-comp|ie-stand">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
<!--[if lt IE 9]>
<script type="text/javascript" src="lib/html5shiv.js"></script>
<script type="text/javascript" src="lib/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="static/h-ui/css/H-ui.min.css" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/H-ui.admin.css" />
<link rel="stylesheet" type="text/css" href="lib/Hui-iconfont/1.0.8/iconfont.css" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/skin/default/skin.css" id="skin" />
<link rel="stylesheet" type="text/css" href="static/h-ui.admin/css/style.css" />
<style type="text/css">
	

#tab {overflow:hidden;zoom:1;background:#000;border:1px solid #000;}
#tab li {float:left;color:#fff;height:30px;	cursor:pointer;	line-height:30px;padding:0 20px;}
#tab li.current {color:#000;background:#ccc;}
#content {border:1px solid #000;border-top-width:0;}
#content div {line-height:25px;display:none;	margin:0 30px;padding:10px 0;}
.highlight {
        color:red;
    }

</style>
<!--[if IE 6]>
<script type="text/javascript" src="lib/DD_belatedPNG_0.0.8a-min.js" ></script>
<script>DD_belatedPNG.fix('*');</script>
<![endif]-->
<title>订单列表</title>
</head>
<body>
<nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页 <span class="c-gray en">&gt;</span> 订单管理 <span class="c-gray en">&gt;</span> 订单列表 <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新" ><i class="Hui-iconfont">&#xe68f;</i></a></nav>
<div class="page-container">
	<div class="text-c"> 搜索订单：
		<input type="text" name="" id="dingdanhao" placeholder=" 订单编号" style="width:250px" class="input-text">
		<button name="" id="soudingdan" class="btn btn-success" type="submit"><i class="Hui-iconfont">&#xe665;</i> 搜订单</button>
	</div>
	<div class="cl pd-5 bg-1 bk-gray mt-20"><span class="r">共有订单：<strong></strong> 条</span> </div>
	<div id="tabdiv" class="mt-20">
		<div id="outer">
		    <ul id="tab">
		        <li>待付款</li>
		        <li class="current">待发货</li>
		        <li>已完成</li>
		        <li>已取消</li>
		        <li>已退货</li>
		    </ul>
		    <div  id="content">
		        <div id="daifukuan">
		         	     
		        </div>
		        <div id="daifahuo" style="display:block;">
		            
		        </div>
		        <div id="yiwancheng">
		           
		        </div>
		        <div id="yiquxiao">
		          
		        </div>
		        <div id="yituihuo">
		         
		        </div>
                
		        
		    </div>
		</div>

		<!-- <table class="table table-border table-bordered table-bg table-hover table-sort">
			<thead>
				<tr class="text-c">
					<th width="40"><input name="" type="checkbox" value=""></th>
					<th width="80">ID</th>
					<th width="100">分类</th>
					<th width="100">封面</th>
					<th>图片名称</th>
					<th width="150">Tags</th>
					<th width="150">更新时间</th>
					<th width="60">发布状态</th>
					<th width="100">操作</th>
				</tr>
			</thead>
			<tbody>
				<tr class="text-c">
					<td><input name="" type="checkbox" value=""></td>
					<td>001</td>
					<td>分类名称</td>
					<td><a href="javascript:;" onClick="picture_edit('图库编辑','picture-show.html','10001')"><img width="210" class="picture-thumb" src="temp/200x150.jpg"></a></td>
					<td class="text-l"><a class="maincolor" href="javascript:;" onClick="picture_edit('图库编辑','picture-show.html','10001')">现代简约 白色 餐厅</a></td>
					<td class="text-c">标签</td>
					<td>2014-6-11 11:11:42</td>
					<td class="td-status"><span class="label label-success radius">已发布</span></td>
					<td class="td-manage"><a style="text-decoration:none" onClick="picture_stop(this,'10001')" href="javascript:;" title="下架"><i class="Hui-iconfont">&#xe6de;</i></a> <a style="text-decoration:none" class="ml-5" onClick="picture_edit('图库编辑','picture-add.html','10001')" href="javascript:;" title="编辑"><i class="Hui-iconfont">&#xe6df;</i></a> <a style="text-decoration:none" class="ml-5" onClick="picture_del(this,'10001')" href="javascript:;" title="删除"><i class="Hui-iconfont">&#xe6e2;</i></a></td>
				</tr>
			</tbody>
		</table> -->


	</div>
</div>

<!--_footer 作为公共模版分离出去-->
<script type="text/javascript" src="lib/jquery/1.9.1/jquery.min.js"></script> 
<script type="text/javascript" src="lib/layer/2.4/layer.js"></script>
<script type="text/javascript" src="static/h-ui/js/H-ui.min.js"></script> 
<script type="text/javascript" src="static/h-ui.admin/js/H-ui.admin.js"></script> <!--/_footer 作为公共模版分离出去-->

<!--请在下方写此页面业务相关的脚本-->
<script type="text/javascript" src="lib/My97DatePicker/4.8/WdatePicker.js"></script> 
<script type="text/javascript" src="lib/datatables/1.10.0/jquery.dataTables.min.js"></script> 
<script type="text/javascript" src="lib/laypage/1.2/laypage.js"></script>
<script type="text/javascript">
$(function(){

	
    

	var daifukuan=$('#daifukuai')
	var daifahuo=$('#daifahuo')
	var yiwancheng=$('#yiwancheng')
	var yiquxiao=$('#yiquxiao')
	var yituihuo=$('#yituihuo')	
	var strong=$('strong')
	$.get("../order/list",function(data) {
			strong.html(data.length);
           	console.log(data)
           	for (var i = 0; i < data.length; i++) {
           		console.log(data[i].orderStatus)
           		var h="";
           		
				if(data[i].orderStatus==0){
					h+='<table id="'+data[i].orderNumber+'" class="table table-border table-bordered table-bg  table-sort"><thead>'
					h+='<th colspan="5">订单号：<span>'+data[i].orderNumber+'</span>&nbsp;&nbsp;&nbsp;&nbsp;收货人姓名:'
					h+='<span>'+data[i].user.nickName+'</span>&nbsp;&nbsp;&nbsp;&nbsp;</th>'
					h+='<th width="160" class="text-c"><span onClick=orderxiangxi('+data[i].orderNumber+',this)  class="label label-success radius">查看详细</span></th>'
					h+='</thead></table>'
					daifukuan.append(h)
				}else if(data[i].orderStatus==1){
					h+='<table id="'+data[i].orderNumber+'" class="table table-border table-bordered table-bg  table-sort"><thead>'
					h+='<th colspan="5">订单号：<span>'+data[i].orderNumber+'</span>&nbsp;&nbsp;&nbsp;&nbsp;收货人姓名:'
					h+='<span>'+data[i].user.nickName+'</span>&nbsp;&nbsp;&nbsp;&nbsp;</th>'
					h+='<th width="160" class="text-c"><span onClick=orderxiangxi('+data[i].orderNumber+',this) class="label label-success radius">查看详细</'
					h+='span>&nbsp;&nbsp;&nbsp;&nbsp;<span onClick=fahuo('+data[i].orderNumber+',this) class="label label-success radius">发货完成'
					h+='</span></th></thead></table>'
					daifahuo.append(h)
				}else if(data[i].orderStatus==2){
					h+='<table id="'+data[i].orderNumber+'" class="table table-border table-bordered table-bg  table-sort"><thead>'
					h+='<th colspan="5">订单号：<span>'+data[i].orderNumber+'</span>&nbsp;&nbsp;&nbsp;&nbsp;收货人姓名:'
					h+='<span>'+data[i].user.nickName+'</span>&nbsp;&nbsp;&nbsp;&nbsp;</th>'
					h+='<th width="160" class="text-c"><span onClick=orderxiangxi('+data[i].orderNumber+',this)  class="label label-success radius">查看详细</span></th>'
					h+='</thead></table>'
					yiwancheng.append(h)
				}else if(data[i].orderStatus==3){
					
					h+='<table id="'+data[i].orderNumber+'" class="table table-border table-bordered table-bg  table-sort"><thead>'
					h+='<th colspan="5">订单号：<span>'+data[i].orderNumber+'</span>&nbsp;&nbsp;&nbsp;&nbsp;收货人姓名:'
					h+='<span>'+data[i].user.nickName+'</span>&nbsp;&nbsp;&nbsp;&nbsp;</th>'
					h+='<th width="160" class="text-c"><span onClick=orderxiangxi('+data[i].orderNumber+',this)  class="label label-success radius">查看详细</span></th>'
					h+='</thead></table>'
					yiquxiao.append(h)
				}else if(data[i].orderStatus==4){
					h+='<table id="'+data[i].orderNumber+'" class="table table-border table-bordered table-bg  table-sort"><thead>'
					h+='<th colspan="5">订单号：<span>'+data[i].orderNumber+'</span>&nbsp;&nbsp;&nbsp;&nbsp;收货人姓名:'
					h+='<span>'+data[i].user.nickName+'</span>&nbsp;&nbsp;&nbsp;&nbsp;</th>'
					h+='<th width="160" class="text-c"><span onClick=orderxiangxi('+data[i].orderNumber+',this)  class="label label-success radius">查看详细</span></th>'
					h+='</thead></table>'
					yituihuo.append(h)
				}
           	};
           	
       });
			var $li = $('#tab li');
			var $ul = $('#content div');
						
			$li.click(function(){
				var $this = $(this);
				var $t = $this.index();
				$li.removeClass();
				$this.addClass('current');
				$ul.css('display','none');
				$ul.eq($t).css('display','block');
			})

        

})
function orderxiangxi(ordernumber,obj){
	if($(obj).html()=='查看详细'){
	var tab=$("#"+ordernumber)
	var ht='<tbody>';
	$.get("../order/xiangxi?number="+ordernumber, function(data) {
		console.log(data)
		for (var i = 0; i < data.length; i++) {
			ht+='<tr class="text-c"><td>'+data[i].goods.goodsName+'</td>'
			ht+='<td><a href="#"><img width="100" class="picture-thumb" src="temp/200x150.jpg"></a></td>'
			ht+='<td class="text-c"><a class="maincolor" href="javascript:;">'+data[i].goodsAttr.material+'&nbsp;&nbsp;&nbsp;&nbsp;'+data[i].goodsAttr.size+'&nbsp;&nbsp;'
			ht+='&nbsp;&nbsp;'+data[i].goodsAttr.color+'</a></td>'
			ht+='<td>$'+data[i].goods.salesPrice+'</td><td class="text-c">'+data[i].payNum+'</td>'
			ht+='<td class="td-manage"><a style="text-decoration:none" class="ml-5"  href="javascript:;"'
			ht+='title="评论"><i class="Hui-iconfont">&#xe6df;</i></a></td></tr>'
		};
		ht+='</tbody>'
		tab.append(ht)
		$(obj).html("收起")
	});
		
	}else{
		$("#"+ordernumber+" tbody").remove() 
		$(obj).html("查看详细")
	}
	
	
}
function fahuo(ordernumber,obj){
	var yiwancheng=$('#yiwancheng');
	var h='';
    layer.confirm('确认发货完成吗？',function(index){
        $.ajax({
            type: 'get',
            url: '../order/xiugai?number='+ordernumber,
            success: function(data){
                $(obj).remove()
                var tab=$("#"+ordernumber)
                h+='<table id="'+ordernumber+'" class="table table-border table-bordered table-bg  table-sort">'
                h+=tab.html()
                h+='</table>'
                yiwancheng.prepend(h);
                tab.remove();
                layer.msg('已发货!',{icon: 6,time:1000});
            },
            error:function(data) {
                layer.msg('发货失败!',{icon: 5,time:1000});
            },
        });     
    });
    /*layer.confirm('确认要发货吗？',function(index){
	$.get("../order/xiugai?number="+ordernumber, function(data) {
		$(obj).remove()
		var tab=$("#"+ordernumber)
		h+='<table id="'+ordernumber+'" class="table table-border table-bordered table-bg  table-sort">'
		h+=tab.html()
		h+='</table>'
		yiwancheng.prepend(h);
		tab.remove();
	});
});*/

	
}
</script>
</body>
</html>